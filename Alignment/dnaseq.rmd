---
title: "Untitled"
author: "Jovan Xavier"
date: "2025-01-25"
output: html_document
---

```{r}
library(tidyverse)
# Load the data
variants <- read.delim("1M_SRR9336468_variants_clean.tsv", header = TRUE, sep = "\t")
```

```{r}
# Inspect the data
head(variants)
```

```{r}
# Analyze the distribution of consequences
table(variants$Consequence)
```

```{r}
# Plot the impact of variants
library(ggplot2)
ggplot(variants, aes(x = Impact)) +
    geom_bar() +
    theme_minimal() +
    labs(title = "Variant Impact Distribution", x = "Impact", y = "Count")
```

```{r}
# Boxplot for DP by Impact
ggplot(variants, aes(x = Impact, y = DP, fill = Impact)) +
  geom_boxplot(outlier.colour = "red", outlier.shape = 16, outlier.size = 2) +
  theme_minimal() +
  scale_fill_brewer(palette = "Set3") +
  labs(
    title = "Sequencing Depth (DP) by Variant Impact",
    x = "Impact",
    y = "Depth (DP)"
  )
```

```{r}
# Heatmap of consequence vs. impact
heatmap_data <- variants %>%
  count(Consequence, Impact) %>%
  tidyr::spread(key = Impact, value = n, fill = 0)
heatmap_data

heatmap_data <- heatmap_data %>% column_to_rownames("Consequence")
heatmap_data
heatmap(as.matrix(heatmap_data))

ggplot(heatmap_data, aes(x = Consequence, y = MODIFIER, fill = n)) +
  geom_tile() +
  scale_fill_gradient(low = "white", high = "blue") +
  theme_minimal() +
  labs(
    title = "Heatmap of Consequence vs. Impact",
    x = "Consequence Type",
    y = "Impact"
  ) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

```{r}

# Filter out MODIFIER variants
filtered_variants <- variants %>%
  filter(Impact != "MODIFIER")

# Bar plot for filtered impacts
ggplot(filtered_variants, aes(x = Impact)) +
  geom_bar(fill = "skyblue") +
  theme_minimal() +
  labs(
    title = "Distribution of Variants with Impact (Excluding MODIFIER)",
    x = "Impact",
    y = "Count"
  )
```

```{r}
# Bar plot with log scale for y-axis
ggplot(variants, aes(x = Impact)) +
  geom_bar(fill = "lightgreen") +
  scale_y_log10() +
  theme_minimal() +
  labs(
    title = "Variant Impact Distribution (Log Scale)",
    x = "Impact",
    y = "Log(Count)"
  )
```


```{r}
# Pie chart for proportional variant impact
variants %>%
  count(Impact) %>%
  mutate(Percentage = n / sum(n) * 100) %>%
  ggplot(aes(x = "", y = Percentage, fill = Impact)) +
  geom_bar(stat = "identity", width = 1) +
  coord_polar("y", start = 0) +
  theme_void() +
  labs(
    title = "Proportions of Variant Impact Categories"
  ) +
  scale_fill_brewer(palette = "Set2")

```


```{r}
# Stacked bar plot: Consequence by impact
variants %>%
  count(Consequence, Impact) %>%
  ggplot(aes(x = Impact, y = n, fill = Consequence)) +
  geom_bar(stat = "identity", position = "stack") +
  theme_minimal() +
  labs(
    title = "Breakdown of Consequences by Impact",
    x = "Impact",
    y = "Count"
  ) +
  scale_fill_brewer(palette = "Set3")

```